Creating retrieval dataset
len of train_dataset: 100000
len of coco val: 5000
Creating model
load checkpoint from ./output/sogclr/sogclr_cc3m_g0.8_e30/checkpoint_30.pth
Start training
Computing features for evaluation...
Evaluation time 0:00:56
coco val: {'txt_r1': 13.1, 'txt_r5': 33.36, 'txt_r10': 45.1, 'txt_r_mean': 30.52, 'img_r1': 10.064376824343237, 'img_r5': 26.298532528289815, 'img_r10': 37.34255667959535, 'img_r_mean': 24.568488677409466, 'r_mean': 27.544244338704733}
zeroshot: {'zeroshot_top1': 24.282, 'zeroshot_top3': 37.2, 'zeroshot_top5': 42.934, 'zeroshot_top10': 50.286}
Training time 0:06:41